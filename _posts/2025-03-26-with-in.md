---
layout: post
title: "with-in-str"
date: 2025-03-25
---
## I was so close, and can't believe I hadn't supposed this was under my nose

So I've been using `with-out-str` to test my printed lines to the console. 
But, you know, when I'm printing things to the console I might also want 
to be able to test code that reads from the console as well!

I'd briefly dabbled with Stubbing, and while lovely, it's already come with 
cautions that it can mask too much. 
So, what are we to do if not stub our read line input? The correlary to 
`with-out-str` is of course, `with-in-str`!

````
  (it "gets input from the user until a valid entry is provided"
    (with-redefs [print-number-prompt (stub :print-prompt)]
      (should= 0 (with-in-str "c\n5\n6\n1\n2" (get-input "")))))
````
With adding the use of '\n' I can even test multiple user inputs in one test! 
This test will test my get-input method with "c" then "5" then "6" (because 
my get in-put method is recursive and continues to prompt and accept user 
input until a valid number, 1-3 is provided). 
When it finally reaches "1" it is successful (and returns 0, to convert to 
index based accounting) and it will never test 2. 


**Cheers!**